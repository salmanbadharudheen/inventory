{% extends 'base.html' %}

{% block page_title %}Asset Inventory{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
    <!-- Filters -->
    <div style="display: flex; gap: 1rem; flex: 1;">
        <form method="get" style="display: flex; gap: 0.75rem; width: 100%;">
            <input type="text" name="q" placeholder="Search asset tag, name..." value="{{ request.GET.q }}"
                class="form-control" style="max-width: 300px;">
            <button type="submit" class="btn btn-primary"><i data-lucide="search"></i></button>
        </form>
    </div>

    <!-- Actions -->
    <h2>Assets</h2>
    <div style="display: flex; gap: 1rem;">
        <a href="{% url 'asset-import' %}" class="btn"
            style="background: var(--bg-body); border: 1px solid var(--border-color);">
            <i data-lucide="upload"></i> Import CSV
        </a>
        <a href="{% url 'asset-create' %}" class="btn btn-primary">
            <i data-lucide="plus"></i> Add New Asset
        </a>
    </div>
</div>

<div class="card" style="padding: 0;">
    <table style="width:100%; text-align:left; border-collapse:collapse;">
        <thead style="background: #F8FAFC;">
            <tr>
                <th style="padding:1rem;">Asset Info</th>
                <th style="padding:1rem;">Category</th>
                <th style="padding:1rem;">Location</th>
                <th style="padding:1rem;">Given To</th>
                <th style="padding:1rem;">Status</th>
                <th style="padding:1rem;">Value</th>
                <th style="padding:1rem;">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for asset in assets %}
            <tr style="border-bottom:1px solid var(--border-color);">
                <td style="padding:1rem;">
                    <a href="{% url 'asset-detail' asset.pk %}" style="text-decoration: none; color: inherit;">
                        <div style="font-weight: 600;">{{ asset.name }}</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary);">{{ asset.asset_tag }}</div>
                    </a>
                </td>
                <td style="padding:1rem;">{{ asset.category.name }}</td>
                <td style="padding:1rem;">
                    <div>{{ asset.branch.code }}</div>
                    <div style="font-size: 0.8rem; color: var(--text-secondary);">{{ asset.room }}</div>
                </td>
                <td style="padding:1rem;">
                    {% if asset.assigned_to %}
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <div class="user-avatar" style="width: 24px; height: 24px; font-size: 0.7rem;">{{
                            asset.assigned_to.username|slice:":2" }}</div>
                        {{ asset.assigned_to.username }}
                    </div>
                    {% else %}
                    <span style="color: var(--text-secondary);">-</span>
                    {% endif %}
                </td>
                <td style="padding:1rem;">
                    <span class="badge status-{{ asset.status|lower }}">{{ asset.get_status_display }}</span>
                </td>
                <td style="padding:1rem;">
                    {% if asset.purchase_price %}
                    <div style="font-weight: 600; color: var(--primary);">{{ asset.currency }} {{ asset.current_value }}
                    </div>
                    <div style="font-size: 0.75rem; color: var(--text-secondary);">Cost: {{ asset.purchase_price }}
                    </div>
                    {% else %}
                    -
                    {% endif %}
                </td>
                <td style="padding:1rem;">
                    <a href="{% url 'asset-detail' asset.pk %}" class="btn" style="padding: 0.25rem 0.5rem;"
                        title="View Detail"><i data-lucide="eye" style="width: 16px;"></i></a>
                    <a href="{% url 'asset-update' asset.pk %}" class="btn" style="padding: 0.25rem 0.5rem;"
                        title="Edit"><i data-lucide="edit-2" style="width: 16px;"></i></a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" style="padding: 2rem; text-align: center; color: var(--text-secondary);">
                    No assets found. Start by adding one!
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<style>
    .badge {
        font-size: 0.75rem;
        padding: 0.25rem 0.6rem;
        border-radius: 9999px;
        font-weight: 500;
        background: #F1F5F9;
        color: #64748B;
    }

    .status-active {
        background: #DCFCE7;
        color: #166534;
    }

    .status-in_storage {
        background: #DBEAFE;
        color: #1E40AF;
    }

    .status-broken {
        background: #FEE2E2;
        color: #991b1b;
    }
</style>
{% endblock %}